import{g as M}from"./video-js-tupHlAe4.js";import{d as U,aK as J,m as i,V as b,G as O,r as u,o as g,h as T,w as r,b as l,e as v,a as n,c as j,f as G,u as p,F as K,ag as X,X as A,R as Q}from"./index-jvtWBQTx.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-xXfAj66y.js";import{R as Z,_ as ee}from"./UserDrawer1.vue_vue_type_script_setup_true_name_UserDrawer_lang-1Uf_rXD0.js";import{i as le,h as ae,b as te,c as re}from"./user-B5eqbc-g.js";import{d as oe}from"./upload-tKNuBlkM.js";const se={style:{display:"flex"}},de={style:{width:"30vw"}},ie={style:{display:"flex","justify-content":"center",width:"50vw"}},ue=n("div",{style:{height:"1vh"}},null,-1),ne=["src"],me=U({name:"UserDrawer"}),Ve=U({...me,emits:["notifyParent"],setup(pe,{expose:C,emit:q}){const P=q,S=()=>{P("notifyParent")},N=J(),c=i(""),V=b({avatar:[{required:!0,message:"请上传用户头像"}],photo:[{required:!0,message:"请上传用户照片"}],username:[{required:!0,message:"请填写用户姓名"}],gender:[{required:!0,message:"请选择性别"}],idCard:[{required:!0,message:"请填写身份证号"}],email:[{required:!0,message:"请填写手机号"}],address:[{required:!0,message:"请填写居住地址"}]}),m=i(!1),a=i({isView:!1,title:"",row:{},id:""});let y=i(""),h=i("");const R=async o=>{if(a.value.id!=o.id){a.value=o;const e=await oe({id:a.value.id});y=e.video,h=e.picture}m.value=!0},D=i(),F=async o=>{c.value;let e={...a.value.row,advice:c.value,doctor:N.userInfo.name};(await le(e)).success&&(m.value=!1,A({title:"success",message:"诊疗成功！",type:"success",duration:3e3}),S())};C({acceptParams:R});const L=o=>({list:o.list,total:o.total,pageNum:o.pageNum,pageSize:o.pageSize}),$=o=>{let e=JSON.parse(JSON.stringify(o));e.createTime&&(e.startTime=e.createTime[0]),e.createTime&&(e.endTime=e.createTime[1]),delete e.createTime;let s={...e,...a.value.row};return ae(s)};O();const B=b({type:1}),w=i(),I=b([{type:"sort",label:"Sort",width:80},{prop:"username",label:"用户姓名",width:85},{prop:"gender",label:"性别",width:80},{prop:"user.detail.age",label:"年龄",width:80},{prop:"idCard",label:"身份证号"},{prop:"email",label:"手机号"},{prop:"address",label:"居住地址",width:240},{prop:"createTime",label:"挂号时间",width:180,search:{el:"date-picker",span:2,props:{type:"datetimerange",valueFormat:"YYYY-MM-DD HH:mm:ss"},defaultValue:["2022-11-12 11:35:00","2024-12-12 11:35:00"]}},{prop:"operation",label:"操作",fixed:"right",width:120}]),Y=({newIndex:o,oldIndex:e})=>{var s;(s=w.value)==null||s.tableData,Q.success("修改列表排序成功")},k=i(null),z=(o,e={})=>{var d,f;const s={title:o,isView:o==="查看",row:{...e},api:o==="新增"?te:o==="编辑"?re:void 0,getTableList:(d=w.value)==null?void 0:d.getTableList,id:e.id};(f=k.value)==null||f.acceptParams(s)};return(o,e)=>{const s=u("el-input"),d=u("el-form-item"),f=u("el-option"),E=u("el-select"),x=u("el-form"),_=u("el-button"),H=u("el-drawer");return g(),T(H,{modelValue:m.value,"onUpdate:modelValue":e[8]||(e[8]=t=>m.value=t),"destroy-on-close":!0,size:"80vw",title:`${a.value.title}用户`},{footer:r(()=>[l(_,{onClick:e[7]||(e[7]=t=>m.value=!1)},{default:r(()=>[v("取消")]),_:1}),l(_,{type:"primary",onClick:F},{default:r(()=>[v("提交")]),_:1})]),default:r(()=>[n("div",se,[n("div",de,[l(x,{ref_key:"ruleFormRef",ref:D,"label-width":"100px","label-suffix":" :",rules:V,disabled:a.value.isView,model:a.value.row,"hide-required-asterisk":a.value.isView},{default:r(()=>[l(d,{label:"用户姓名",prop:"username"},{default:r(()=>[l(s,{modelValue:a.value.row.username,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.row.username=t),placeholder:"请填写用户姓名",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"性别",prop:"gender"},{default:r(()=>[l(E,{modelValue:a.value.row.gender,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.row.gender=t),placeholder:"请选择性别",clearable:""},{default:r(()=>[(g(!0),j(K,null,G(p(M),t=>(g(),T(f,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"身份证号",prop:"idCard"},{default:r(()=>[l(s,{modelValue:a.value.row.idCard,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.row.idCard=t),placeholder:"请填写身份证号",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"手机号",prop:"email"},{default:r(()=>[l(s,{modelValue:a.value.row.email,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.row.email=t),placeholder:"请填写手机号",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"居住地址",prop:"address"},{default:r(()=>[l(s,{modelValue:a.value.row.address,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.row.address=t),placeholder:"请填写居住地址",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"患者描述",prop:"address"},{default:r(()=>[l(s,{modelValue:a.value.row.address,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.row.address=t),placeholder:"请填写居住地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","disabled","model","hide-required-asterisk"])]),n("div",ie,[l(p(Z),{style:{width:"90%",height:"100%"},src:p(y),poster:"",controls:!0,autoplay:!0,loop:!0,volume:.6},null,8,["src"])])]),n("div",null,[ue,l(x,{"label-width":"100px","label-suffix":" :",rules:V,model:a.value.row,"hide-required-asterisk":a.value.isView},{default:r(()=>[l(d,{label:"眼震视图"},{default:r(()=>[n("img",{style:{height:"37.5vw",width:"100%"},src:p(h)},null,8,ne)]),_:1}),l(d,{label:"机器判断"},{default:r(()=>[v(" 判断为右跳型眼震 ")]),_:1}),l(d,{label:"医生评价"},{default:r(()=>[l(s,{modelValue:c.value,"onUpdate:modelValue":e[6]||(e[6]=t=>c.value=t),style:{width:"100vw","margin-bottom":"20px"},rows:5,type:"textarea",placeholder:"Please input"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model","hide-required-asterisk"])]),l(W,{ref_key:"proTable",ref:w,columns:I,"request-api":$,"init-param":B,"data-callback":L,onDargSort:Y},{operation:r(t=>[l(_,{type:"primary",link:"",icon:p(X),onClick:ce=>z("查看",t.row)},{default:r(()=>[v("查看")]),_:2},1032,["icon","onClick"])]),_:1},8,["columns","init-param"]),l(ee,{ref_key:"drawerRef",ref:k},null,512)]),_:1},8,["modelValue","title"])}}});export{Ve as _};
