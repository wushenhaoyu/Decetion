import{ah as L,R as O,X as u,d as y,m as v,r,o as k,h as D,w as a,b as s,u as R,ab as M,e as h,z as g,t as j,a as b,p as A,g as F}from"./index-jvtWBQTx.js";import{_ as N}from"./_plugin-vue_export-helper-x3n3nnut.js";const W=(n,d={},i,p="warning")=>new Promise((l,e)=>{L.confirm(`是否${i}?`,"温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:p,draggable:!0}).then(async()=>{if(!await n(d))return e(!1);O({type:"success",message:`${i}成功!`}),l(!0)})}),P=async(n,d,i={},p=!0,l=".xlsx")=>{p&&u({title:"温馨提示",message:"如果数据庞大会导致下载缓慢哦，请您耐心等待！",type:"info",duration:3e3});try{const e=await n(i),m=new Blob([e]);if("msSaveOrOpenBlob"in navigator)return window.navigator.msSaveOrOpenBlob(m,d+l);const f=window.URL.createObjectURL(m),c=document.createElement("a");c.style.display="none",c.download=`${d}${l}`,c.href=f,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(f)}catch{}},q=n=>(A("data-v-dd116d8b"),n=n(),F(),n),H=q(()=>b("div",{class:"el-upload__text"},[h("将文件拖到此处，或"),b("em",null,"点击上传")],-1)),X={class:"el-upload__tip"},G=y({name:"ImportExcel"}),J=y({...G,setup(n,{expose:d}){const i=v(!1),p=v(1),l=v(!1),e=v({title:"",fileSize:5,fileType:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]}),m=o=>{e.value={...e.value,...o},l.value=!0},f=()=>{e.value.tempApi&&P(e.value.tempApi,`${e.value.title}模板`)},c=async o=>{let t=new FormData;t.append("file",o.file),t.append("isCover",i.value),await e.value.importApi(t),e.value.getTableList&&e.value.getTableList(),l.value=!1},S=o=>{const t=e.value.fileType.includes(o.type),_=o.size/1024/1024<e.value.fileSize;return t||u({title:"温馨提示",message:"上传文件只能是 xls / xlsx 格式！",type:"warning"}),_||setTimeout(()=>{u({title:"温馨提示",message:`上传文件大小不能超过 ${e.value.fileSize}MB！`,type:"warning"})},0),t&&_},E=()=>{u({title:"温馨提示",message:"最多只能上传一个文件！",type:"warning"})},$=()=>{u({title:"温馨提示",message:`批量添加${e.value.title}失败，请您重新上传！`,type:"error"})},B=()=>{u({title:"温馨提示",message:`批量添加${e.value.title}成功！`,type:"success"})};return d({acceptParams:m}),(o,t)=>{const _=r("el-button"),x=r("el-form-item"),U=r("upload-filled"),V=r("el-icon"),C=r("el-upload"),T=r("el-switch"),z=r("el-form"),I=r("el-dialog");return k(),D(I,{modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=w=>l.value=w),title:`批量添加${e.value.title}`,"destroy-on-close":!0,width:"580px",draggable:""},{default:a(()=>[s(z,{class:"drawer-multiColumn-form","label-width":"100px"},{default:a(()=>[s(x,{label:"模板下载 :"},{default:a(()=>[s(_,{type:"primary",icon:R(M),onClick:f},{default:a(()=>[h(" 点击下载 ")]),_:1},8,["icon"])]),_:1}),s(x,{label:"文件上传 :"},{default:a(()=>[s(C,{action:"#",class:"upload",drag:!0,limit:p.value,multiple:!0,"show-file-list":!0,"http-request":c,"before-upload":S,"on-exceed":E,"on-success":B,"on-error":$,accept:e.value.fileType.join(",")},{tip:a(()=>[g(o.$slots,"tip",{},()=>[b("div",X,"请上传 .xls , .xlsx 标准格式文件，文件最大为 "+j(e.value.fileSize)+"M",1)],!0)]),default:a(()=>[g(o.$slots,"empty",{},()=>[s(V,{class:"el-icon--upload"},{default:a(()=>[s(U)]),_:1}),H],!0)]),_:3},8,["limit","accept"])]),_:3}),s(x,{label:"数据覆盖 :"},{default:a(()=>[s(T,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=w=>i.value=w)},null,8,["modelValue"])]),_:1})]),_:3})]),_:3},8,["modelValue","title"])}}}),Y=N(J,[["__scopeId","data-v-dd116d8b"]]);export{Y as I,W as a,P as u};
